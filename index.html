<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan Nutricional Mafer</title>
    <style>
        :root {
            --primary: #4CAF50; /* Green for health/veggies */
            --secondary: #FF9800; /* Orange for energy/fruits */
            --accent: #2196F3; /* Blue for water/calm */
            --bg: #F5F7FA;
            --card: #ffffff;
            --text: #333333;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding-bottom: 80px; /* Space for nav */
        }

        header {
            background: linear-gradient(135deg, var(--primary), #2E7D32);
            color: white;
            padding: 20px;
            text-align: center;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        h1 { margin: 0; font-size: 1.5rem; }
        h2 { font-size: 1.2rem; color: var(--primary); margin-bottom: 10px; }
        p { margin: 5px 0; font-size: 0.95rem; }

        /* Navigation */
        nav {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        nav button {
            background: none;
            border: none;
            color: #888;
            font-size: 0.8rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-weight: bold;
        }

        nav button.active { color: var(--primary); }
        nav button span { font-size: 1.5rem; margin-bottom: 2px; }

        /* Sections */
        .section { display: none; padding: 20px; animation: fadeIn 0.3s; }
        .section.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Cards */
        .card {
            background: var(--card);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border-left: 5px solid var(--primary);
        }

        .meal-title { font-weight: bold; color: #555; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 1px; }
        .meal-content { margin-top: 5px; font-size: 1rem; }
        .note { font-size: 0.8rem; color: #666; font-style: italic; margin-top: 5px; }

        /* Day Selector */
        .day-scroller {
            display: flex;
            overflow-x: auto;
            padding-bottom: 10px;
            gap: 10px;
            margin-bottom: 15px;
            scrollbar-width: none;
        }
        .day-btn {
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 8px 15px;
            border-radius: 20px;
            white-space: nowrap;
            font-weight: bold;
        }
        .day-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Tracker */
        input, select, textarea {
            width: 100%;
            padding: 10px;
            margin: 5px 0 15px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            font-family: inherit;
        }
        button.action-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 12px;
            width: 100%;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
        }
        .log-entry {
            border-left-color: var(--accent);
        }

        /* Randomizer */
        .random-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px;
            width: 100%;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 20px;
            box-shadow: 0 4px 0 #388E3C;
            transition: transform 0.1s;
        }
        .random-btn:active { transform: translateY(4px); box-shadow: none; }

    </style>
</head>
<body>

    <header>
        <h1>üçé Plan Mafer</h1>
        <p>1300 Kcal | Sin Gluten | Low FODMAP</p>
    </header>

    <div id="plan" class="section active">
        <div class="day-scroller" id="dayScroller">
            </div>
        
        <div id="menuContent">
            </div>
    </div>

    <div id="ideas" class="section">
        <h2>üé≤ ¬øQu√© comemos hoy?</h2>
        <p>Genera una combinaci√≥n v√°lida basada en tu lista de sustitutos.</p>
        
        <button class="random-btn" onclick="generateRandomMeal('lunch')">Generar Almuerzo</button>
        <button class="random-btn" style="background-color: var(--accent); box-shadow: 0 4px 0 #1976D2;" onclick="generateRandomMeal('dinner')">Generar Cena</button>
        
        <div id="randomResult" class="card" style="display:none; border-left-color: var(--secondary);">
            <div class="meal-title">Sugerencia:</div>
            <div class="meal-content" id="randomText"></div>
            <div class="note">Recuerda: Preparaciones a la plancha, horno o air fryer. ¬°Cero frituras!</div>
        </div>

        <div class="card">
            <h3>Recordatorios Clave</h3>
            <ul style="padding-left: 20px; font-size:0.9rem;">
                <li><strong>Vegetales:</strong> 2 tazas cocidos (mejor digesti√≥n).</li>
                <li><strong>Frutas:</strong> 3 raciones al d√≠a.</li>
                <li><strong>Agua:</strong> 8 vasos (o infusiones de Toronjil/An√≠s).</li>
                <li><strong>Prohibido:</strong> Az√∫car, l√°cteos con lactosa, gluten.</li>
            </ul>
        </div>
    </div>

    <div id="tracker" class="section">
        <h2>üìä Diario de Salud</h2>
        <div class="card">
            <div class="meal-title">Nuevo Registro</div>
            <label>Glucosa (mg/dL):</label>
            <input type="number" id="glucose" placeholder="Ej: 95">
            
            <label>S√≠ntomas (Insulina/H√≠gado):</label>
            <input type="text" id="symptoms" placeholder="Ej: Fatiga, antojos, dolor abdominal...">
            
            <label>Notas:</label>
            <textarea id="notes" rows="2" placeholder="Com√≠ algo fuera del plan?"></textarea>
            
            <button class="action-btn" onclick="saveLog()">Guardar Registro</button>
        </div>

        <h3>Historial</h3>
        <div id="logHistory"></div>
        <br>
        <button onclick="clearLogs()" style="color: red; background: none; border: none; width: 100%; text-align: center;">Borrar Historial</button>
    </div>

    <nav>
        <button class="active" onclick="switchTab('plan', this)">
            <span>üìÖ</span> Plan
        </button>
        <button onclick="switchTab('ideas', this)">
            <span>üë©‚Äçüç≥</span> Ideas
        </button>
        <button onclick="switchTab('tracker', this)">
            <span>üìà</span> Salud
        </button>
    </nav>

    <script>
        // --- DATA: MENUS FROM PDF [Source: 1-13] ---
        const menuDays = {
            1: {
                desayuno: "Queso semi duro (90g) + Arepa Asada (100g) + Aguacate (1 trozo).",
                almuerzo: "Pechuga empanizada (Air Fryer 90g) + Papas (2 unids) + Ensalada rallada.",
                cena: "Hamburguesa de Carne Molida + Casabe + Tomate/Lechuga.",
                snack: "Fruta (Jugo o trozos)."
            },
            2: {
                desayuno: "Jam√≥n de Pavo (3 reb) + Arepa de batata (1) + Alfalfa/Tomate.",
                almuerzo: "Calabacines rellenos carne molida (90g) + Arroz Blanco.",
                cena: "Ensalada de At√∫n (90g) + Arepa peque√±a + Cebolla/Tomate.",
                snack: "Fruta + Galleta de arroz."
            },
            3: {
                desayuno: "Pollo en salsa (90g) + Papas rellenas (2 unids) + Aceite (1 cdta).",
                almuerzo: "At√∫n al ajillo (90g) + Yuca sancochada + Ensalada de berros.",
                cena: "Carne molida (4 cdas) + Tortilla de ma√≠z (Burrito) + Guacamole.",
                snack: "Fruta de preferencia."
            },
            4: {
                desayuno: "Carne Molida sin grasa + Arepa con Ajonjol√≠ + Aguacate en ensalada.",
                almuerzo: "Arroz con pollo y vegetales + Ensalada.",
                cena: "Jam√≥n y Queso Mozzarella B√∫fala + Tortilla de pl√°tano + Vegetales.",
                snack: "Fruta."
            },
            5: {
                desayuno: "Ensalada de At√∫n (6 cdas) + Casabe (60g).",
                almuerzo: "Parrilla de Carne con vegetales + Bollitos + Ensalada Mixta.",
                cena: "Bu√±uelos de Yuca (Air Fryer).",
                snack: "Fruta."
            },
            6: {
                desayuno: "Pollo esmechado (90g) + Tortillas de pl√°tano verde/maduro + Margarina.",
                almuerzo: "Asado Negro (90g) + Arroz (1 tz) + Ensalada Tomate/Pepino.",
                cena: "Jam√≥n de Pavo + Galletas de Arroz (2 paq) + Ensalada.",
                snack: "Fruta."
            },
            7: {
                desayuno: "Pavo (90g) + Crepes de harina de arroz + Margarina y vegetales.",
                almuerzo: "Pescado al Horno (90g) + Casabe (40g) + Ensalada papa/zanahoria.",
                cena: "Queso Amarillo + 1 reb Jam√≥n + Yuca + Alfalfa.",
                snack: "Fruta."
            },
            8: {
                desayuno: "Pollo esmechado (90g) + Arepa asada (100g) + Aguacate.",
                almuerzo: "Pollo a la plancha (90g) + Arroz (1 tz) + Br√≥coli con tomate.",
                cena: "Tortilla calabac√≠n / 2 papas / 2 Claras de Huevo + Jam√≥n rallado.",
                snack: "Fruta."
            },
            9: {
                desayuno: "Pl√°tano maduro horneado + Queso mozzarella b√∫fala.",
                almuerzo: "Hamburguesa carne (90g) + Pan sin gluten + Vegetales + 1 papa brava.",
                cena: "Ensalada Capresa (30g Mozzarella B√∫fala) + Galleta soda.",
                snack: "T√© fr√≠o sin az√∫car o Fruta."
            },
            10: {
                desayuno: "Queso de cabra (90g) + Arepa mediana (100g) + Margarina.",
                almuerzo: "Croquetas de pescado (Air Fryer 90g) + Arroz (1 tz).",
                cena: "Sopa combinada de auyama/apio + Carne (90g).",
                snack: "Jugo o Fruta."
            }
        };

        // --- DATA: SUBSTITUTION LISTS [Source: 17-24] ---
        const foodLists = {
            proteins: ["Pollo (90g)", "Carne Magra (90g)", "Pescado (90g)", "Lomo de Cerdo (90g)", "At√∫n (90g)", "Queso B√∫fala/Cabra (30g)", "2 Huevos (Max 3/sem)"],
            starches: ["Arroz (1/2 taza)", "Quinoa (1/2 taza)", "Yuca sancochada", "Batata al horno", "Pl√°tano maduro/verde", "Arepa (1/2 unidad)", "Pasta sin gluten"],
            veggies: ["Calabac√≠n", "Vainitas", "Zanahoria", "Espinacas", "Acelgas", "Berenjena", "Champi√±ones", "Br√≥coli (cuidado gases)"],
            fats: ["Aguacate (1/8)", "Aceite de Oliva (1 cdta)", "Aceitunas (5 unid)", "Nueces (2 unid)", "Almendras (6 unid)"]
        };

        // --- LOGIC: RENDER TAB 1 ---
        function renderDays() {
            const scroller = document.getElementById('dayScroller');
            scroller.innerHTML = '';
            for(let i=1; i<=10; i++) {
                const btn = document.createElement('button');
                btn.className = `day-btn ${i===1 ? 'active' : ''}`;
                btn.innerText = `D√≠a ${i}`;
                btn.onclick = () => showDay(i, btn);
                scroller.appendChild(btn);
            }
            showDay(1); // Default
        }

        function showDay(day, btnElement) {
            if(btnElement) {
                document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('active'));
                btnElement.classList.add('active');
            }
            
            const menu = menuDays[day];
            const html = `
                <div class="card">
                    <div class="meal-title">üç≥ Desayuno</div>
                    <div class="meal-content">${menu.desayuno}</div>
                </div>
                <div class="card" style="border-left-color: var(--secondary);">
                    <div class="meal-title">üçé Merienda AM</div>
                    <div class="meal-content">1 Porci√≥n de Fruta (Lista 3).</div>
                </div>
                <div class="card">
                    <div class="meal-title">üç≤ Almuerzo</div>
                    <div class="meal-content">${menu.almuerzo}</div>
                    <div class="note">A√±adir 1 cdta aceite de oliva o 1/8 aguacate.</div>
                </div>
                <div class="card" style="border-left-color: var(--secondary);">
                    <div class="meal-title">üç™ Merienda PM</div>
                    <div class="meal-content">${menu.snack}</div>
                </div>
                <div class="card" style="border-left-color: var(--accent);">
                    <div class="meal-title">üåô Cena</div>
                    <div class="meal-content">${menu.cena}</div>
                </div>
            `;
            document.getElementById('menuContent').innerHTML = html;
        }

        // --- LOGIC: TAB 2 RANDOMIZER ---
        function generateRandomMeal(type) {
            const p = foodLists.proteins[Math.floor(Math.random() * foodLists.proteins.length)];
            const s = foodLists.starches[Math.floor(Math.random() * foodLists.starches.length)];
            const v = foodLists.veggies[Math.floor(Math.random() * foodLists.veggies.length)];
            const f = foodLists.fats[Math.floor(Math.random() * foodLists.fats.length)];
            
            let text = "";
            if (type === 'lunch') {
                // Lunch formula: Protein + Starch + Veggie + Fat
                text = `<strong>Prote√≠na:</strong> ${p}<br><strong>Carbohidrato:</strong> ${s}<br><strong>Vegetal:</strong> ${v}<br><strong>Grasa:</strong> ${f}`;
            } else {
                // Dinner formula: Lighter protein + Veggie + (Optional small starch)
                text = `<strong>Prote√≠na:</strong> ${p}<br><strong>Acompa√±ante:</strong> ${s} (o Casabe)<br><strong>Vegetal:</strong> ${v}`;
            }
            
            document.getElementById('randomText').innerHTML = text;
            document.getElementById('randomResult').style.display = 'block';
        }

        // --- LOGIC: TAB 3 TRACKER (LOCAL STORAGE) ---
        function saveLog() {
            const gluc = document.getElementById('glucose').value;
            const symp = document.getElementById('symptoms').value;
            const note = document.getElementById('notes').value;
            const date = new Date().toLocaleDateString() + " " + new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

            if(!gluc && !symp && !note) return alert("Escribe algo para guardar.");

            const entry = { date, gluc, symp, note };
            let logs = JSON.parse(localStorage.getItem('maferHealthLogs') || '[]');
            logs.unshift(entry); // Add to top
            localStorage.setItem('maferHealthLogs', JSON.stringify(logs));
            
            renderLogs();
            // Clear inputs
            document.getElementById('glucose').value = '';
            document.getElementById('symptoms').value = '';
            document.getElementById('notes').value = '';
            alert("Registro guardado ‚ú®");
        }

        function renderLogs() {
            const logs = JSON.parse(localStorage.getItem('maferHealthLogs') || '[]');
            const container = document.getElementById('logHistory');
            container.innerHTML = '';

            logs.forEach(log => {
                const div = document.createElement('div');
                div.className = 'card log-entry';
                div.innerHTML = `
                    <div class="meal-title">${log.date}</div>
                    ${log.gluc ? `<div>ü©∏ Glucosa: <strong>${log.gluc}</strong></div>` : ''}
                    ${log.symp ? `<div>‚ö†Ô∏è S√≠ntomas: ${log.symp}</div>` : ''}
                    ${log.note ? `<div class="note">üìù ${log.note}</div>` : ''}
                `;
                container.appendChild(div);
            });
        }

        function clearLogs() {
            if(confirm("¬øBorrar todo el historial?")) {
                localStorage.removeItem('maferHealthLogs');
                renderLogs();
            }
        }

        // --- NAVIGATION ---
        function switchTab(tabId, btn) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        // --- INIT ---
        renderDays();
        renderLogs();

    </script>
</body>
</html>
